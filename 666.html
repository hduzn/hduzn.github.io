<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>幸运大转盘 - 抽奖系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(147, 51, 234, 0.5); }
            50% { box-shadow: 0 0 40px rgba(147, 51, 234, 0.8); }
        }
        
        .wheel-container {
            position: relative;
            display: inline-block;
            filter: drop-shadow(0 10px 30px rgba(0,0,0,0.2));
        }
        
        .wheel-canvas {
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            border-radius: 50%;
        }
        
          
        .spin-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20;
            background: linear-gradient(145deg, #ffffff, #f3f4f6);
            border: 3px solid #e5e7eb;
            animation: pulse-glow 2s infinite;
        }
        
        .spin-button:hover {
            transform: translate(-50%, -50%) scale(1.1);
            background: linear-gradient(145deg, #f9fafb, #e5e7eb);
        }
        
        .spin-button:active {
            transform: translate(-50%, -50%) scale(0.95);
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear forwards;
            z-index: 10;
        }
        
        @keyframes confetti-fall {
            to {
                transform: translateY(800px) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* 美化滚动条 */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(145deg, #a855f7, #ec4899);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(145deg, #9333ea, #db2777);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-50 min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- 标题部分 -->
        <header class="text-center mb-6">
            <h1 class="text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2">
                <i class="fas fa-gift mr-3"></i>幸运大转盘
            </h1>
        </header>

        <!-- 主要内容区域 -->
        <main class="max-w-6xl mx-auto">
            <!-- 控制面板 -->
            <section class="bg-white rounded-2xl shadow-xl p-4 mb-6">
                <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                    <div class="flex items-center gap-4">
                        <label for="prizeCount" class="text-lg font-semibold text-gray-700">
                            <i class="fas fa-cog mr-2"></i>数量：
                        </label>
                        <input 
                            type="number" 
                            id="prizeCount" 
                            min="2" 
                            max="100" 
                            value="8" 
                            class="w-24 px-4 py-2 border-2 border-purple-300 rounded-lg focus:outline-none focus:border-purple-500 text-center text-lg font-semibold"
                        >
                        <button 
                            onclick="updateWheel()" 
                            class="px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 font-semibold shadow-md hover:shadow-lg"
                        >
                            <i class="fas fa-sync-alt mr-2"></i>更新转盘
                        </button>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <span class="text-gray-600">当前数量：</span>
                        <span id="currentCount" class="text-2xl font-bold text-purple-600">8</span>
                    </div>
                </div>
            </section>

            <!-- 转盘区域 -->
            <section class="bg-white rounded-2xl shadow-xl p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                    <div class="flex flex-col items-center">
                        <div class="wheel-container">
                            <canvas id="wheelCanvas" width="450" height="450" class="wheel-canvas"></canvas>
                            <button 
                                id="spinButton"
                                onclick="spinWheel()" 
                                class="spin-button w-24 h-24 rounded-full text-gray-700 font-bold text-lg shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center"
                            >
                                <span class="text-center">
                                    <i class="fas fa-play text-2xl text-purple-600"></i>
                                    <div class="text-sm mt-1 text-purple-600 font-semibold">开始</div>
                                </span>
                            </button>
                        </div>
                        <!-- 等待抽奖提示 -->
                        <div id="waitingPrompt" class="text-center text-gray-500 mt-4">
                            <i class="fas fa-hand-pointer text-2xl mb-2 text-purple-300"></i>
                            <p class="text-base">点击开始按钮进行抽奖</p>
                        </div>
                    </div>

                    <!-- 右侧中奖信息 -->
                    <div class="flex flex-col items-center justify-center min-h-[350px]">
                        <div id="result" class="text-center opacity-0 transition-opacity duration-500 w-full max-w-sm">
                            <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-8 shadow-inner border-2 border-purple-200">
                                <h3 class="text-3xl font-bold text-gray-800 mb-4">🎉 恭喜你！</h3>
                                <div class="text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-4" id="resultText"></div>
                                <div class="text-lg text-gray-600">幸运号码</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 历史记录 -->
            <section class="mt-6 bg-white rounded-2xl shadow-xl p-4">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">
                    <i class="fas fa-history mr-2"></i>抽奖历史
                </h2>
                <div id="history" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3">
                    <p class="text-gray-500 col-span-full text-center py-4">暂无抽奖记录</p>
                </div>
            </section>
        </main>
    </div>

    <script>
        let canvas = document.getElementById('wheelCanvas');
        let ctx = canvas.getContext('2d');
        let currentRotation = 0;
        let isSpinning = false;
        let prizeCount = 8;
        let history = [];

        // 颜色数组
        const colors = [
            '#C0392B', '#8E44AD', '#27AE60', '#D68910', '#E74C3C', '#2980B9',
            '#16A085', '#F39C12', '#D35400', '#7D3C98', '#C0392B', '#2874A6',
            '#148F77', '#7E5109', '#922B21', '#5B2C6F', '#1E8449', '#7D6608'
        ];

        // 初始化转盘
        function initWheel() {
            drawWheel();
        }

        // 绘制转盘
        function drawWheel() {
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = 200;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // 绘制外圈装饰
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius + 20, 0, 2 * Math.PI);
            ctx.fillStyle = '#8b5cf6';
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius + 15, 0, 2 * Math.PI);
            ctx.fillStyle = '#ffffff';
            ctx.fill();

            // 绘制扇形
            const anglePerSection = (2 * Math.PI) / prizeCount;
            
            for (let i = 0; i < prizeCount; i++) {
                const startAngle = i * anglePerSection - Math.PI / 2; // 从顶部开始
                const endAngle = (i + 1) * anglePerSection - Math.PI / 2;

                // 绘制扇形背景
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.closePath();
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();

                // 绘制边框
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 2;
                ctx.stroke();

                // 绘制内部装饰圈
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius * 0.12, 0, 2 * Math.PI);
                ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.fill();

                // 绘制文字
                ctx.save();
                ctx.translate(centerX, centerY);
                ctx.rotate(startAngle + anglePerSection / 2);
                ctx.textAlign = 'center';
                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 20px Arial';
                ctx.shadowColor = 'rgba(0, 0, 0, 0.5)';
                ctx.shadowBlur = 4;
                ctx.fillText(i + 1, radius * 0.85, 5);
                ctx.restore();
            }

            // 绘制中心圆
            ctx.beginPath();
            ctx.arc(centerX, centerY, 55, 0, 2 * Math.PI);
            ctx.fillStyle = '#ffffff';
            ctx.fill();
            ctx.strokeStyle = '#8b5cf6';
            ctx.lineWidth = 4;
            ctx.stroke();
            
            // 中心圆内部装饰
            ctx.beginPath();
            ctx.arc(centerX, centerY, 45, 0, 2 * Math.PI);
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 2;
            ctx.stroke();
        }

        // 更新转盘
        function updateWheel() {
            const input = document.getElementById('prizeCount');
            const newCount = parseInt(input.value);
            
            if (newCount >= 2 && newCount <= 100) {
                prizeCount = newCount;
                document.getElementById('currentCount').textContent = prizeCount;
                drawWheel();
                hideResult();
            } else {
                alert('请输入2-100之间的数字');
            }
        }

        // 转动转盘
        function spinWheel() {
            if (isSpinning) return;

            isSpinning = true;
            hideResult();

            const spinButton = document.getElementById('spinButton');
            spinButton.disabled = true;
            spinButton.classList.add('opacity-50', 'cursor-not-allowed');

            // 随机选择奖品
            const prizeIndex = Math.floor(Math.random() * prizeCount);
            const prizeNumber = prizeIndex + 1;

            // 简化旋转逻辑，随机旋转
            const targetAngle = Math.random() * 360;
            const spins = 5; // 转几圈
            const totalRotation = spins * 360 + targetAngle;

            // 应用旋转
            currentRotation += totalRotation;
            canvas.style.transform = `rotate(${currentRotation}deg)`;

            // 4秒后显示结果
            setTimeout(() => {
                showResult(prizeNumber);
                addToHistory(prizeNumber);
                createConfetti();
                isSpinning = false;
                spinButton.disabled = false;
                spinButton.classList.remove('opacity-50', 'cursor-not-allowed');
            }, 4000);
        }

        // 显示结果
        function showResult(prizeNumber) {
            const result = document.getElementById('result');
            const resultText = document.getElementById('resultText');
            const waitingPrompt = document.getElementById('waitingPrompt');
            
            resultText.textContent = prizeNumber;
            result.classList.remove('opacity-0');
            result.classList.add('opacity-100');
            waitingPrompt.classList.add('opacity-0', 'hidden');
        }

        // 隐藏结果
        function hideResult() {
            const result = document.getElementById('result');
            const waitingPrompt = document.getElementById('waitingPrompt');
            
            result.classList.remove('opacity-100');
            result.classList.add('opacity-0');
            waitingPrompt.classList.remove('opacity-0', 'hidden');
        }

        // 添加到历史记录
        function addToHistory(prizeNumber) {
            history.push(prizeNumber);
            if (history.length > 12) {
                history.shift();
            }
            updateHistoryDisplay();
        }

        // 更新历史记录显示
        function updateHistoryDisplay() {
            const historyDiv = document.getElementById('history');
            
            if (history.length === 0) {
                historyDiv.innerHTML = '<p class="text-gray-500 col-span-full text-center py-4">暂无抽奖记录</p>';
                return;
            }

            historyDiv.innerHTML = history.map((prize, index) => `
                <div class="bg-gradient-to-br from-purple-100 to-pink-100 rounded-lg p-3 text-center shadow-md transform hover:scale-105 transition-transform">
                    <div class="text-xs text-gray-600 mb-1">第${index + 1}次</div>
                    <div class="text-xl font-bold text-purple-600">${prize}</div>
                </div>
            `).join('');
        }

        // 创建彩纸效果
        function createConfetti() {
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FECA57', '#FF9FF3', '#A29BFE'];
            const wheelSection = document.querySelector('.grid.grid-cols-1.md\\:grid-cols-2.gap-8.items-center');
            
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.top = '0px';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    wheelSection.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        // 初始化
        initWheel();
    </script>
</body>
</html>